!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a=(new e.Error).stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="5be1ecbd-db8f-4a4b-9eaf-21aef850b95a",e._sentryDebugIdIdentifier="sentry-dbid-5be1ecbd-db8f-4a4b-9eaf-21aef850b95a")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7124],{53375:function(e,a,t){t.d(a,{r:function(){return r}}),t(9150);var r="gnx4pm0"},40785:function(e,a,t){t.d(a,{bu:function(){return l},eQ:function(){return o},gw:function(){return r},tG:function(){return n}}),t(9150),t(99466),t(60336),t(79881),t(73800),t(7098),t(30624),t(72462),t(32490),t(40662),t(50056),t(14611),t(27531),t(73435),t(54243);var r={articleMetaStandard:"_1ajq89k2 _1ajq89k0",articleMetaFeature:"_1ajq89kc _1ajq89k2 _1ajq89k0",articleMetaFeatureSplit:"_1ajq89kw _1ajq89k2 _1ajq89k0",articleMetaSpecial:"_1ajq89k8 _1ajq89k2 _1ajq89k0",articleMetaSpecialSplit:"_1ajq89k8 _1ajq89k2 _1ajq89k0",articleMetaSpecialOverlay:"_1ajq89kc _1ajq89k2 _1ajq89k0",pageHeader:"_1ajq89k10 _1ajq89k2 _1ajq89k0",homepageOnBoarding:"_1ajq89k11 _1ajq89k2 _1ajq89k0"},o={articleMetaStandard:"_1ajq89k5 _1ajq89k3 _1lp96da0",articleMetaFeature:"_1ajq89kd _1ajq89k5 _1ajq89k3 _1lp96da0",articleMetaFeatureSplit:"_1ajq89k14 _1ajq89k5 _1ajq89k3 _1lp96da0",articleMetaSpecial:"_1ajq89k9 _1ajq89k5 _1ajq89k3 _1lp96da0",articleMetaSpecialSplit:"_1ajq89k9 _1ajq89k5 _1ajq89k3 _1lp96da0",articleMetaSpecialOverlay:"_1ajq89kd _1ajq89k5 _1ajq89k3 _1lp96da0",pageHeader:"_1ajq89k18 _1ajq89k5 _1ajq89k3 _1lp96da0",homepageOnBoarding:"_1ajq89k5 _1ajq89k3 _1lp96da0"},n={articleMetaStandard:"_1ajq89k1 _1ajq89k0",articleMetaFeature:"_1ajq89ka _1ajq89k1 _1ajq89k0",articleMetaFeatureSplit:"_1ajq89kg _1ajq89k1 _1ajq89k0",articleMetaSpecial:"_1ajq89k6 _1ajq89k1 _1ajq89k0",articleMetaSpecialSplit:"_1ajq89k6 _1ajq89k1 _1ajq89k0",articleMetaSpecialOverlay:"_1ajq89ka _1ajq89k1 _1ajq89k0",pageHeader:"_1ajq89kk _1ajq89k1 _1ajq89k0",homepageOnBoarding:"_1ajq89kl _1ajq89k1 _1ajq89k0"},l={articleMetaStandard:"_1ajq89k4 _1ajq89k3 _1lp96da0",articleMetaFeature:"_1ajq89kb _1ajq89k4 _1ajq89k3 _1lp96da0",articleMetaFeatureSplit:"_1ajq89ko _1ajq89k4 _1ajq89k3 _1lp96da0",articleMetaSpecial:"_1ajq89k7 _1ajq89k4 _1ajq89k3 _1lp96da0",articleMetaSpecialSplit:"_1ajq89k7 _1ajq89k4 _1ajq89k3 _1lp96da0",articleMetaSpecialOverlay:"_1ajq89kb _1ajq89k4 _1ajq89k3 _1lp96da0",pageHeader:"_1ajq89ks _1ajq89k4 _1ajq89k3 _1lp96da0",homepageOnBoarding:"_1ajq89kt _1ajq89k4 _1ajq89k3 _1lp96da0"}},44477:function(e,a,t){var r=t(35683),o=t(40785);a.Z=e=>{let{layout:a,tooltipRef:t}=e;return(0,r.jsx)("span",{ref:t,className:o.gw[a],children:(0,r.jsx)("svg",{className:o.eQ[a],width:"9",height:"9",viewBox:"0 0 9 9",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Following",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.8004 1.78498L3.604 7.79332L0.599609 5.14239L1.39356 4.24259L3.48917 6.09166L7.89276 1L8.8004 1.78498Z"})})})}},93757:function(e,a,t){var r=t(35683),o=t(40785);a.Z=e=>{let{layout:a,tooltipRef:t}=e;return(0,r.jsx)("span",{ref:t,className:o.tG[a],children:(0,r.jsx)("svg",{className:o.bu[a],width:"9",height:"9",viewBox:"0 0 9 9",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Follow",children:(0,r.jsx)("path",{d:"M5 0H4V4H0V5H4V9H5V5H9V4H5V0Z"})})})}},58372:function(e,a,t){t.d(a,{D_:function(){return n},Sg:function(){return r},v7:function(){return o}});let r={FOLLOW_CATEGORY:"Error: Could not follow this topic. Try again.",UNFOLLOW_CATEGORY:"Error: Could not unfollow this topic. Try again.",FOLLOW_AUTHOR:"Error: Could not follow this author. Try again.",UNFOLLOW_AUTHOR:"Error: Could not unfollow this author. Try again.",MAX_FOLLOWS_REACHED:"Error: You have reached the maximum number of follows.",DEFAULT:"Error: An error occurred. Please try again."};class o extends Error{constructor(e,a){super(),this.name="FollowsError",this.code=e,this.originalError=a}}let n=e=>{let a=r[e.code]||null;return console.error(`FOLLOWS ERROR: ${a}`," ORIGINAL:",!e.originalError&&e.message?e.message:e.originalError),a}},84633:function(e,a,t){t.d(a,{S3:function(){return j},Xe:function(){return w},hE:function(){return f}});var r=t(35683),o=t(66123),n=t(23411),l=t(58372),i=t(7209),c=t(84994),u=t(7914),s=t(51477),d=t(60725);let _=(0,o.createContext)({followResource:async()=>!0,unfollowResource:async()=>!0,sendAnalyticsEvent:()=>{},canFollow:!1,loading:!0}),w=()=>(0,o.useContext)(_),f=e=>{let a=(0,o.useContext)(_),t=a.authors?.find(a=>a.id===e);return!!(t=a.categories?.find(a=>a.id===e)||t)},k=e=>{let{userEmail:a,token:t}=e;(0,d.Z)(a,["Verge Follows"],"follows",window.location.href,t).catch(e=>{e instanceof Error&&console.error(`Error subscribing user to follows newsletter: ${e.message}`)})},h=e=>{let a="production";return`user:${e.slice(0,6)}:${a?a+":":""}follows`},j=e=>{let{children:a}=e,[t,d]=(0,o.useState)(null),[w,f]=(0,o.useState)(!0),[j,p]=(0,o.useState)(!1),{user:q}=(0,c.aC)(),g=(0,i.z$)(),{fetchCaptchaToken:O}=(0,u.m)(s.e);(0,o.useEffect)(()=>{window.location.search.match("errorTestMode")&&p(!0)},[]),(0,o.useEffect)(()=>{if(!q)return;let e=h(q.uid),a=localStorage.getItem(e);a&&d(JSON.parse(a)),(0,n.Ev)({userId:q.uid}).then(a=>{d(a),f(!1);try{localStorage.setItem(e,JSON.stringify(a))}catch{}}).catch(()=>d(null))},[q]);let L=(0,o.useCallback)(e=>{d({categories:t?.categories||[],authors:e})},[t]),S=(0,o.useCallback)(e=>{d({authors:t?.authors||[],categories:e})},[t]),m=(0,o.useCallback)(e=>{let{eventType:a,type:t,name:r,gaComponentName:o}=e;g?.emit({event:a,[a]:{click_text:r.toLowerCase(),type:"author"===t?"author":"topic",position:o}})},[g]),y=(0,o.useCallback)(async e=>{let{resourceId:a,name:r,type:o,gaComponentName:i}=e;if(j)throw new l.v7("author"===o?"FOLLOW_AUTHOR":"FOLLOW_CATEGORY","TEST: FOLLOW");if(!q)return!1;let c="author"===o?L:S,u="author"===o?"authors":"categories",s=[...t?.[u]||[]];if(s.find(e=>e.id===a))return!1;if((t?.authors||[]).length+(t?.categories||[]).length>=30)throw new l.v7("MAX_FOLLOWS_REACHED","");c([...s,{id:a,metadata:{name:r}}]);try{let e=await (0,n.ZN)({userId:q.uid,resourceId:a,name:r,type:o});c(e)}catch(e){throw c(s),new l.v7("author"===o?"FOLLOW_AUTHOR":"FOLLOW_CATEGORY",e)}return m({eventType:"follow",type:o,name:r,gaComponentName:i}),0===s.length&&k({userEmail:q.email||"",token:await O()}),!0},[t,q,S,L,j,m,O]),E=(0,o.useCallback)(async e=>{let{resourceId:a,name:r,type:o,gaComponentName:i}=e;if(j)throw new l.v7("author"===o?"UNFOLLOW_AUTHOR":"UNFOLLOW_CATEGORY","TEST: UNFOLLOW");if(!q)return!1;let c="author"===o?L:S,u="author"===o?"authors":"categories",s=[...t?.[u]||[]];c(s.filter(e=>e.id!==a));try{let e=await (0,n.fv)({userId:q.uid,resourceIds:[a],type:o});c(e)}catch(e){throw c(s),new l.v7("author"===o?"UNFOLLOW_AUTHOR":"UNFOLLOW_CATEGORY",e)}return m({eventType:"unfollow",type:o,name:r,gaComponentName:i}),!0},[t,q,S,L,j,m]);return(0,r.jsx)(_.Provider,{value:{...t,followResource:y,unfollowResource:E,sendAnalyticsEvent:m,canFollow:!!q,loading:w},children:a})}},23411:function(e,a,t){t.d(a,{$j:function(){return p},Ev:function(){return i},SU:function(){return k},VV:function(){return _},ZN:function(){return n},cU:function(){return j},fv:function(){return l},nR:function(){return h}});var r=t(24767);let o=async(e,a)=>{if(a.ok)return await a.json();throw Error(`Unable to complete ${e} action, HTTP ${a.status} response`)},n=async e=>{let{userId:a,resourceId:t,name:r,type:n}=e,l=await fetch(`/api/preferences/${a}/follows`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,name:r,type:n})});return await o("follow",l)},l=async e=>{let{userId:a,resourceIds:t,type:r}=e,n=await fetch(`/api/preferences/${a}/follows`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,type:r})});return await o("unfollow",n)},i=async e=>{let{userId:a}=e,t=await fetch(`/api/preferences/${a}/follows`,{method:"GET",headers:{"Content-Type":"application/json"}});return await o("get follows",t)},c=async e=>{let{userId:a}=e,t=await i({userId:a}),r=[l({userId:a,resourceIds:t.authors.map(e=>e.id),type:"author"}),l({userId:a,resourceIds:t.categories.map(e=>e.id),type:"category"})];await Promise.all(r).then(()=>{console.log("Unfollowed all authors and topics")}).catch(e=>{throw console.error("Error unfollowing all authors and topics"),e})};r.Z&&(window.vergeFollow=n,window.vergeUnFollow=l,window.vergeGetFollows=i,window.vergeUnfollowAll=()=>c({userId:"1234"}));let u="followItem",s="followItemSource",d="followOnboarding",_=(e,a,t)=>{let r=new URLSearchParams({[u]:e,[s]:a});t&&r.set(d,"1");let o=encodeURIComponent(`${window.location.pathname}?${r.toString()}`);window.location.href=`/auth/login?returnPath=${o}&itm_campaign=follow&itm_medium=site`},w=()=>{let e=new URLSearchParams(window.location.search);return e.has(u)?e.get(u):null},f=()=>{let e=new URLSearchParams(window.location.search);return e.has(s)?e.get(s):null},k=()=>{let e=new URLSearchParams(window.location.search);return e.has(d)?"1"===e.get(d):null},h=(e,a)=>{let t=w();return f()===a&&t===e},j=()=>{let e=new URL(window.location.href);e.search="",window.history.replaceState({},"",e)},p=(e,a,t,r)=>`follow-${e}-${t}${r?`_${r}`:""}-${a}`},30904:function(e,a,t){t.d(a,{BZ:function(){return n},J0:function(){return l}});var r=t(66123);let o=(0,r.createContext)(null),n=()=>{let e=(0,r.useContext)(o);return e&&e.authorList||null},l=()=>{let e=(0,r.useContext)(o);return e&&e.categoryList||null};a.ZP=o}}]);