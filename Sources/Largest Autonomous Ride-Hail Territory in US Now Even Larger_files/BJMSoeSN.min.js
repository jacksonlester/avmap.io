import{d as c}from"./chunks/C6NDGylb.min.js";import{W as l}from"./DBBL1asN.min.js";class d extends l{constructor(){super(...arguments),this.isLocked=!1,this.truncateContent=async()=>{if(this.isLocked)return;this.isLocked=!0,this.textContainer.innerHTML=this.textContainer.getAttribute("data-original-content");let n;for(let t=0;t<this.textContainer.childNodes.length;t++){const e=this.textContainer.childNodes[t];if(e.nodeType!==Node.COMMENT_NODE&&!(e.nodeType===Node.TEXT_NODE&&e.textContent?.trim()==="")){if(e.nodeType===Node.ELEMENT_NODE){const h=e;if(h.childNodes.length===0||h.textContent?.trim()==="")continue}n=t}}for(let t=n+1;t<this.textContainer.childNodes.length;t++)this.textContainer.removeChild(this.textContainer.childNodes[t]);if(this.getLinesCount(this.textContainer)<=this.maxLines)return;this.textContainer.style.setProperty("opacity","0");const o=this.textContainer.textContent;let s=0,r=o.length,a=o;for(;s<=r;){const t=Math.floor((s+r)/2),e=o.substring(0,t)+"â€¦";this.textContainer.textContent=e,this.getLinesCount(this.textContainer)<=this.maxLines?(a=e,s=t+1):r=t-1}this.textContainer.textContent=a,this.textContainer.style.setProperty("opacity","1"),window.requestAnimationFrame(()=>this.isLocked=!1)},this.getLinesCount=n=>{const i=window.getComputedStyle(n),o=parseFloat(i.lineHeight),s=n.offsetHeight,r=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),t=s-r-a;return Math.round(t/o)}}connectedCallback(){if(this.textContainer=this.getSlotElement("truncate-text-container"),!this.textContainer){console.error('Error: w-truncated-text requires a child element to have `data-slot="truncate-text-container"`');return}try{this.maxLines=parseInt(this.getAttribute("lines"))}catch{console.error('Could not parse w-truncated-text "lines" param:',this.getAttribute("lines"));return}this.init()}init(){this.textContainer.setAttribute("data-original-content",this.textContainer.innerHTML),this.truncateContent(),new ResizeObserver(c(this.truncateContent,50)).observe(this.textContainer),new MutationObserver(this.truncateContent).observe(this.textContainer,{attributes:!1,childList:!0,subtree:!0})}}customElements.get("w-truncated-text")||customElements.define("w-truncated-text",d);
